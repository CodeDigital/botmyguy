<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta charset="utf-8">
  <title>Bot MyGuy | Template</title>
    <!--Import Google Icon Font-->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!--Import materialize.css-->
    <link type="text/css" rel="stylesheet" href="../../node_modules/materialize-css/dist/css/materialize.min.css" media="screen,projection" />
    
    <!--Let browser know website is optimized for mobile-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

</head>

<body class=" blue-grey darken-4 white-text">

  <nav style="height: 65px;">
    <div class="nav-wrapper pink darken-2" style="height: 65px;">
      <div class="valign-wrapper left">
        <a href="#" data-target="slide-out" data-activates="slide-out" class="sidenav-trigger show-on-large">
          <i class="large material-icons" style="font-size: 40px;">menu</i>
        </a>
      </div>
      <div class="valign-wrapper left">
        <h3 class="brand-logo">Bot My Guy</h3>
      </div>

      <ul class="right">
        <li class="hoverable" style="padding-left: 20px;padding-right: 20px;" id="close-btn">
          <i class="large material-icons">remove</i>
        </li>
        <li class="hoverable" style="padding-left: 20px;padding-right: 20px;" id="max-btn">
          <i class="large material-icons">crop_free</i>
        </li>
        <li class="hoverable" style="padding-left: 20px;padding-right: 20px;" id="close-btn">
          <i class="large material-icons">close</i>
        </li>
      </ul>
    </div>
  </nav>

  <!-- Menu -->

    <ul id="slide-out" class="sidenav pink darken-4">
      <li class="white-text center-align">
        <br>
        <!-- <img src="../assets/img/logo-white.png" style="width: 60%; margin-bottom: -45px;margin-top: -20px;" alt=""> -->

        <div class="container"><h4>Welcome, USER</h4></div></li>
      <li class="center-align">
        <button class="btn btn-large green pulse hoverable" onclick="connect();" id="cButton">
          <i class="large material-icons left" id="connectIcon">power</i>
            <div class="preloader-wrapper small active hide" id="loadingCircle" style="margin-left: -15px; margin-right: 10px; margin-top: 10px;">
              <div class="spinner-layer">
                <div class="circle-clipper left">
                  <div class="circle"></div>
                </div>
                <div class="gap-patch">
                  <div class="circle"></div>
                </div>
                <div class="circle-clipper right">
                  <div class="circle"></div>
                </div>
              </div>
            </div>
          Connect</button>
        <button class="btn btn-large red waves-effect right hide" onclick="disconnect();" id="dcButton">
          <i class="large material-icons left">eject</i> Disconnect</button>
      </li>
      <br>
      <li class="indigo darken-2">
        <a href="dashboard.html" class="white-text"><i class="material-icons white-text">dashboard</i> Dashboard</a>
      </li>
      <li>
        <a href="commands.html" class="white-text">
          <i class="material-icons white-text">announcement</i> Commands</a>
      </li>
      <li>
        <a href="poll.html" class="white-text">
          <i class="material-icons white-text">pie_chart</i> Polls</a>
      </li>
      <li>
        <a href="timed-messages.html" class="white-text">
          <i class="material-icons white-text">timer</i> Timed Events</a>
      </li>
      <li class="white-text">
        <ul class="collapsible collapsible-accordion" style="margin-top: 0px;">
          <li>
            <a class="collapsible-header white-text">
              <i class="material-icons white-text" style="margin-left: 16px;">videogame_asset</i>
              <p style="display: inline;">Stream Games</p>
              <i class="material-icons white-text right" style="display: block; margin-right: 10px;">arrow_drop_down</i>
            </a>
            <div class="collapsible-body indigo darken-3">
              <ul>
                <li>
                  <a href="#" class="white-text">
                    <i class="material-icons white-text">repeat</i> Game Cycle</a>
                </li>
                <li>
                  <a href="#" class="white-text"><i class="material-icons white-text">pets</i> Werewolves</a>
                </li>
                <li>
                  <a href="#" class="white-text"><i class="material-icons white-text">people</i> Community</a>
                </li>
              </ul>
            </div>
          </li>
        </ul>
      </li>
      <br>
      <div class="center-align">
        <a href="#" class="white-text btn-floating btn btn-large pink darken-2 waves-effect" style="margin: 0 10px;">
          <i class="material-icons white-text">settings</i>
        </a>
        <a href="#" class="white-text btn-floating btn btn-large pink darken-2 waves-effect" style="margin: 0 10px;">
          <i class="material-icons white-text">help_outline</i>
        </a>
        <a href="https://github.com/CodeDigital/botmyguy" target="_blank" class="white-text btn-floating btn btn-large pink darken-2 waves-effect" style="margin: 0 10px;">
          <i class="material-icons white-text">code</i>
        </a>
      </div>
    </ul>

    <div class="center-align">
          <h1 style="margin-top: 0px;margin-bottom: -15px;">Dashboard</h1>
          <h6>Watch as events unfold in your stream!</h6>
          <div class="divider"></div>
    </div>
  <div>
    <div class="row">
      <div class="col s6" style="padding-right: -100px;">
        <h2>Chat</h2>
        <ul class="collection grey darken-4" style="width: 47vw;height: calc(100vh - 310px);overflow-y:auto; ">
          <li class="collection-item avatar pink darken-3">
            <img src="../assets/img/logo-white.png" alt="" class="circle">
            <!-- <h6 class="title">Test User</h6> -->
            <span class="title">Test User</span>
            <p>Test Text</p>
          </li>
        </ul>
      </div>
      <div class="col s6">
        <div class="row">
          <h2>Events</h2>
        </div>
        <div class="row">
          <h2>Top Viewers</h2>
        </div>
      </div>
    </div>

  </div>


  <!--JavaScript at end of body for optimized loading-->
  <script type="text/javascript" src="../../node_modules/materialize-css/dist/js/materialize.min.js"></script>

  <script src="../titlebar.js"></script>
  <script src="menu.js"></script>

  <script type="text/javascript">

    var isConnecting = false;

    const { ipcRenderer } = require('electron');
    const fs = require('fs');
    const db = require('../../database/database.js');

    db.getSettings(function (settings) {
      var userWelcome = document.getElementById('welcomeText');
      var wText = userWelcome.innerHTML;
      wText = wText.substring(0, 9) + settings.user;
      userWelcome.innerHTML = wText;
    });

    function connect() {
      if(!isConnecting){
        var connectIcon = document.getElementById('connectIcon');
        var loadingCircle = document.getElementById('loadingCircle');

        loadingCircle.className = "preloader-wrapper small active left";
        connectIcon.style = "display:none;"
        ipcRenderer.send('connect');
        isConnecting = true;
      }
    }

    ipcRenderer.on('connect:success', function (e) {
      var connectButton = document.getElementById('cButton');
      var disconnectButton = document.getElementById('dcButton');

      connectButton.className = "btn btn-large green waves-effect right hide"; 
      disconnectButton.className = "btn btn-large red waves-effect right";
      isConnecting = false;
    });

    function disconnect() {
      ipcRenderer.send('disconnect');
    }

    ipcRenderer.on('disconnect:success', function (e) {
      var connectButton = document.getElementById('cButton');
      var disconnectButton = document.getElementById('dcButton');

      connectButton.className = "btn btn-large green waves-effect right";
      disconnectButton.className = "btn btn-large red waves-effect right hide";
    });

  </script>

</body>

</html>