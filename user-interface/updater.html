<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta charset="utf-8">
  <title>Bot MyGuy | Template</title>
  <!--Import Google Icon Font-->
  <link rel="stylesheet" href="../node_modules/material-icons/iconfont/material-icons.css">
  <!--Import materialize.css-->
  <link type="text/css" rel="stylesheet" href="../node_modules/materialize-css/dist/css/materialize.min.css" media="screen,projection"
  />

  <!--Let browser know website is optimized for mobile-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link rel="import" href="dashboard.html" id="dashboardLink">
  <link rel="import" href="commands.html" id="commandsLink">

  <!--JavaScript at end of body for optimized loading-->
  <script type="text/javascript" src="../node_modules/materialize-css/dist/js/materialize.min.js"></script>

  <script src="titlebar.js"></script>
  <script src="../node_modules/p5/lib/p5.min.js"></script>

</head>

<body class="blue-grey darken-4 white-text" style="overflow-y: hidden;">

  <nav style="height: 56px;-webkit-app-region: drag;">
    <div class="nav-wrapper pink darken-2" style="height: 56px;">
      <!-- <div class="valign-wrapper left grey darken-4" style="margin-left: -10px;">
<img src="../assets/icons/Icon.svg" style="height: 65px; padding-left: 15px;margin-top: 32.5px;margin-left: 10px;border-top-left-radius: 50px;border-bottom-left-radius: 50px;"
  class="brand-logo grey darken-4" alt="">
        <h3 class="brand-logo grey darken-4" style="margin-left: 90px;padding: 20px;padding-left: 10px;border-top-right-radius: 50px;border-bottom-right-radius: 50px;">Bot My Guy</h3>
      </div> -->

      <div class="valign-wrapper center-align">
        <h3 class="brand-logo">Bot My Guy</h3>
      </div>

      <ul class="right">
        <li class="hoverable" style="padding-left: 20px;padding-right: 20px;user-select: none;cursor: pointer;-webkit-app-region: no-drag;"
          id="min-btn">
          <i class="large material-icons">remove</i>
        </li>
        <li class="hoverable red" style="padding-left: 20px;padding-right: 20px;user-select: none;cursor: pointer;-webkit-app-region: no-drag;"
          id="close-btn">
          <i class="large material-icons">close</i>
        </li>
      </ul>
    </div>
  </nav>

  <div class="row">
    <div class="col s12 text-center center-align">
      <h5>Updating...</h5>

    </div>
  </div>

  <div class="row center-align text-center" style="margin-top: -20px;">
    <div class="col s12 center-align text-center" id="loadingDiv">
    </div>
<small>'Game of Life' Code by Daniel Shiffman.
  <a onclick="goToLink();" style="cursor: pointer;">Link</a>
</small>

  </div>

  <script>

  const twitchauth = require('../bot-server/twitch-authenticate.js');
 const { shell, ipcRenderer } = require('electron');

    console.log('this working?');
    twitchauth.getInfoNoReset(function (result) {
      var bot = result;
      console.log(bot);
      ipcRenderer.send('botauth:done', bot);
      ipcRenderer.send('loading:complete');
    });

      function goToLink() {
        shell.openExternal('https://p5js.org/examples/simulate-game-of-life.html');
      }

    var w;
    var columns;
    var rows;
    var board;
    var next;

    function setup() {
      var c = createCanvas(535, 400);
      c.parent('loadingDiv');

      w = 20; // Calculate columns and rows 
      columns = floor(width / w);
      rows = floor(height / w); // Wacky way to make a 2D array is JS 
      board = new Array(columns);
      for (var i = 0; i < columns; i++) {
        board[i] = new Array(rows);
      } // Going to use multiple 2D arrays and swap them 
      next = new Array(columns);
      for (i = 0; i < columns; i++) {
        next[i] = new Array(rows);
      }
      init();
    }

    function draw() {
      background('#263238');
      generate();
      for (var i = 0; i < columns; i++) {
        for (var j = 0; j < rows; j++) {
          if ((board[i][j] == 1)) fill('#c2185b');
          else fill('#263238');
          stroke('#263238');
          rect(i * w, j * w, w - 1, w - 1);
        }
      }
    } // reset board when mouse is pressed 
    function mousePressed() {
      init();
    } // Fill board randomly

    function init() {
      for (var i = 0; i < columns; i++) {
        for (var j = 0; j < rows; j++) { // Lining the edges with 0 s
          if (i == 0 || j == 0 || i == columns - 1 || j == rows - 1) {
            board[i][j] = 0; // Filling the rest randomly 
          } else {
            board[i][j] = floor(random(2));
          }
          next[i][j] = 0;
        }
      }
    } // The process of creating the new generation 

    setInterval(function () {
      init();
    }, 3000);

    function generate() { // Loop through every spot in our 2 D array and check spots neighbors
      for (var x = 1; x < columns - 1; x++) {
        for (var y = 1; y < rows - 1; y++) { // Add up all the states in a 3 x3 surrounding grid
          var neighbors = 0;
          for (var i = -1; i <= 1; i++) {
            for (var j = -1; j <= 1; j++) {
              neighbors += board[x + i][y + j];
            }
          } // A little trick to subtract the current cell 's state since
          // we added it in the above loop
          neighbors -= board[x][y];
          // Rules of Life
          if ((board[x][y] == 1) && (neighbors < 2)) next[x][y] = 0; // Loneliness
          else if ((board[x][y] == 1) && (neighbors > 3)) next[x][y] = 0; // Overpopulation
          else if ((board[x][y] == 0) && (neighbors == 3)) next[x][y] = 1; // Reproduction
          else next[x][y] = board[x][y]; // Stasis
        }
      }

      // Swap!
      var temp = board;
      board = next;
      next = temp;
    }
  </script>

</body>

</html>